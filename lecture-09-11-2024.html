<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Wednesday, Sep 11</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics 422</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="lectures.html">Lectures</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Wednesday, Sep 11</h1>

</div>


<p>You can also download a <a href="lecture-09-11-2024.pdf">PDF</a> copy
of this lecture.</p>
<div id="optimum-stratification" class="section level2">
<h2>Optimum Stratification</h2>
<p>If we can assign elements to strata, how should this be done so as to
minimize the variance of <span class="math inline">\(\hat\mu\)</span> or
<span class="math inline">\(\hat\tau\)</span>? Recall that the variance
of <span class="math inline">\(\hat\mu\)</span> under stratified random
sampling is <span class="math display">\[
  V(\hat\mu) = \frac{1}{N^2}\sum_{j=1}^L
N_j^2\left(1-\frac{n_j}{N_j}\right)\frac{\sigma_j^2}{n_j}.
\]</span> Note: Since <span class="math inline">\(V(\hat\tau) =
N^2V(\hat\mu)\)</span>, any strategy that reduces <span
class="math inline">\(V(\hat\mu)\)</span> will also reduce <span
class="math inline">\(V(\hat\tau)\)</span>.</p>
<p><strong>Question</strong>: For a stratified sampling design, how
should we <em>stratify</em> elements so as to make <span
class="math inline">\(V(\hat\mu)\)</span> or <span
class="math inline">\(V(\hat\tau)\)</span> small?</p>
<!-- It is important to point out here than by minimizing the within-stratum variances we will tend to maximize the between-strata variance. -->
<p>Various algorithms exist for stratification based on one or more
<em>auxiliary variables</em>. Here an <strong>auxiliary
variable</strong> is a variable with the properties that (a) we know the
value of the auxiliary variable(s) for <em>all</em> elements in the
population and (b) the auxiliary variable(s) is/are associated
(correlated) with the target variable.</p>
<ol style="list-style-type: decimal">
<li>Stratification by a single quantitative auxiliary variable that is
assumed to be correlated with the target variable (e.g., the “cumulative
root frequency” method).</li>
</ol>
<p><img src="lecture-09-11-2024_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Stratification by one or more categorical auxiliary variables (or
quantitative auxiliary variables that have been turned into categories)
that form many smaller “atomic strata” to be collapsed into fewer larger
strata as needed.</li>
</ol>
<p>Comment: In principle, stratification improves with more strata
(i.e., larger <span class="math inline">\(L\)</span>), but there are
diminishing returns.</p>
</div>
<div id="stratified-random-sampling-via-double-sampling"
class="section level2">
<h2>Stratified Random Sampling via Double Sampling</h2>
<p>Two requirements for stratified random sampling and inference that
may not be met.</p>
<ol style="list-style-type: decimal">
<li><p>The capability of sampling separately from each stratum (via
simple random sampling).</p></li>
<li><p>Knowledge of the stratum sizes — i.e., <span
class="math inline">\(N_1, N_2, \dots, N_L\)</span> for use in computing
the estimators <span class="math display">\[
  \hat\mu = \frac{N_1}{N}\bar{y}_1 + \frac{N_2}{N}\bar{y}_2 + \cdots +
\frac{N_L}{N}\bar{y}_L = \sum_{i=j}^L \frac{N_j}{N}\bar{y}_j,
\]</span> and <span class="math display">\[
  \hat\tau = N_1\bar{y}_1 + N_2\bar{y}_2 + \cdots + N_L\bar{y}_L =
\sum_{j=1}^LN_j\bar{y}_j,
\]</span> respectively.</p></li>
</ol>
<p>What if these requirements are not met? Options?</p>
<ol style="list-style-type: decimal">
<li><p>Use <em>simple random sampling</em>.</p></li>
<li><p>Use <em>double sampling</em> if <span class="math inline">\(N_1,
N_2, \dots, N_L\)</span> are unknown.</p></li>
<li><p>Use <em>post-stratification</em> if <span
class="math inline">\(N_1, N_2, \dots, N_L\)</span> are known but SRS
was used.</p></li>
</ol>
<p><strong>Double sampling</strong> (aka “two-phase” sampling) is a
general sampling technique for obtaining observations of an
<em>auxiliary variable</em> that are needed for a design and/or needed
to compute an estimator.<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a> Here this auxiliary variable is whatever we
use to stratify the elements in the population.</p>
<ol style="list-style-type: decimal">
<li><p>Obtain a larger sample of size <span
class="math inline">\(n&#39;\)</span> using simple random sampling.
Determine the stratum membership of each element. Compute the number of
elements in each stratum (<span class="math inline">\(n_1&#39;,
n_2&#39;, \dots, n_L&#39;\)</span>).</p></li>
<li><p>Apply stratified random sampling to the sample obtained in the
first phase by applying simple random sampling to each of the
sub-samples of sampled elements.</p></li>
</ol>
<p>We can estimate <span class="math inline">\(N_j/N\)</span> with <span
class="math inline">\(n_j&#39;/n&#39;\)</span>. The estimator of <span
class="math inline">\(\mu\)</span> then becomes <span
class="math display">\[
  \hat\mu = \frac{n_1&#39;}{n&#39;}\bar{y}_1 +
\frac{n_2&#39;}{n&#39;}\bar{y}_2 + \cdots +
\frac{n_L&#39;}{n&#39;}\bar{y}_L = \sum_{j=1}^L
\frac{n_j&#39;}{n&#39;}\bar{y}_j,
\]</span> To estimate <span class="math inline">\(\tau\)</span> we can
use <span class="math display">\[
  \hat\tau = N\frac{n_1&#39;}{n&#39;}\bar{y}_1 +
N\frac{n_2&#39;}{n&#39;}\bar{y}_2 + \cdots +
N\frac{n_L&#39;}{n&#39;}\bar{y}_L = N\sum_{j=1}^L
\frac{n_j&#39;}{n&#39;}\bar{y}_j.
\]</span> The variances of these estimators can be written as <span
class="math display">\[
  V(\hat\mu) = \text{a big mess} \ \ \ \text{and} \ \ \ V(\hat\tau) =
N^2 \times \text{a big mess}.
\]</span> Typically these variances are <em>larger</em> than what they
would be had we been able to use stratified random sampling
<em>without</em> double sampling, but <em>smaller</em> than if we had
used just simple random sampling.</p>
<p><strong>Comment</strong>: We can also seek to optimize the double
sampling design by picking <span class="math inline">\(n&#39;\)</span>
(the number of elements in the first sample) and <span
class="math inline">\(n_1, n_2, \dots, n_L\)</span> (the number of
elements in the second sample that are members of each stratum and
within the first sample) for a fixed cost.</p>
<strong>Example</strong>: Suppose an survey is to be conducted at an
organization of 1000 employees. We want to estimate the mean scores to
questions where responses are likely related to the political
affiliation of the employees. While ideally a stratified random sampling
design would be applied using political affiliation, this information is
unknown to the employer. Consider the following double sampling design.
The sample obtained in the first phase via simple random sampling can be
summarized as follows.
<table class="table table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Politics
</th>
<th style="text-align:center;">
<span class="math inline">\(n_j&#39;\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Liberal
</td>
<td style="text-align:center;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderate
</td>
<td style="text-align:center;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
Conservative
</td>
<td style="text-align:center;">
20
</td>
</tr>
</tbody>
</table>
And the sample obtained in the second stage using stratified random
sampling can be summarized as follows.
<table class="table table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Politics
</th>
<th style="text-align:center;">
<span class="math inline">\(n_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\bar{y}_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(s_j\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Liberal
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
5.50
</td>
<td style="text-align:center;">
0.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Moderate
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
4.00
</td>
<td style="text-align:center;">
2.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Conservative
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
2.25
</td>
<td style="text-align:center;">
1.1
</td>
</tr>
</tbody>
</table>
<p>What is the estimate of <span class="math inline">\(\mu\)</span>?</p>
<!-- A useful thing to note here is that the sample mean (i.e., the standard estimator from SRS) implicitly uses the sample sizes from the second phase sample to "estimate" the stratum proportions. -->
</div>
<div id="comparison-of-sampling-designs" class="section level2">
<h2>Comparison of Sampling Designs</h2>
<p>Consider a simulation study with a population with three strata where
stratification would be beneficial. How do <em>simple random
sampling</em>, <em>double sampling</em>, and <em>stratified random
sampling</em> compare with respect to the sampling distribution of the
estimator of <span class="math inline">\(\mu\)</span> = 50?</p>
<p><img src="lecture-09-11-2024_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>The term “two-phase” should not be confused with the
terms “two-stage” or “multi-stage” sampling, which are used to describe
some kinds of cluster sampling designs that we will discuss later.<a
href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
